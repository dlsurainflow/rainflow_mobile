{"ast":null,"code":"import _regeneratorRuntime from \"@babel/runtime/regenerator\";\nimport _slicedToArray from \"@babel/runtime/helpers/slicedToArray\";\n\nvar _this = this,\n    _jsxFileName = \"D:\\\\Github\\\\rainflow_mobile\\\\src\\\\Screens\\\\HomeMap.js\";\n\nimport React, { Component, useState, useEffect, useRef } from \"react\";\nimport StyleSheet from \"react-native-web/dist/exports/StyleSheet\";\nimport View from \"react-native-web/dist/exports/View\";\nimport Text from \"react-native-web/dist/exports/Text\";\nimport TextInput from \"react-native-web/dist/exports/TextInput\";\nimport TouchableOpacity from \"react-native-web/dist/exports/TouchableOpacity\";\nimport Image from \"react-native-web/dist/exports/Image\";\nimport Alert from \"react-native-web/dist/exports/Alert\";\nimport { WebView } from \"react-native-webview\";\nimport { html_map } from \"./html_map\";\nimport { MaterialCommunityIcons } from \"@expo/vector-icons\";\nimport { useFocusEffect } from '@react-navigation/native';\nimport StepModal from \"../components/NodeModal\";\n\nvar HomeMap = function HomeMap(props) {\n  var _useState = useState(),\n      _useState2 = _slicedToArray(_useState, 2),\n      markers = _useState2[0],\n      setMarkers = _useState2[1];\n\n  var _useState3 = useState(),\n      _useState4 = _slicedToArray(_useState3, 2),\n      injectJS = _useState4[0],\n      setInjectJS = _useState4[1];\n\n  var _useState5 = useState([]),\n      _useState6 = _slicedToArray(_useState5, 2),\n      currentNodes = _useState6[0],\n      setCurrentNodes = _useState6[1];\n\n  var _useState7 = useState(false),\n      _useState8 = _slicedToArray(_useState7, 2),\n      sidebar = _useState8[0],\n      setSidebar = _useState8[1];\n\n  var webViewRef = useRef();\n\n  var getNodes = function getNodes() {\n    return _regeneratorRuntime.async(function getNodes$(_context) {\n      while (1) {\n        switch (_context.prev = _context.next) {\n          case 0:\n            _context.next = 2;\n            return _regeneratorRuntime.awrap(fetch('https://rainflow.live/api/map/all', {\n              method: 'GET',\n              headers: {\n                'Content-Type': 'application/json',\n                'Accept': 'application/json'\n              }\n            }).then(function (response) {\n              console.log(response.status);\n              if (response.status == 200) response.json().then(function (data) {\n                setMarkers(data);\n              });else {\n                Alert.alert('Error retrieving reports! (Code: ' + response.status + ')');\n              }\n            }));\n\n          case 2:\n          case \"end\":\n            return _context.stop();\n        }\n      }\n    }, null, null, null, Promise);\n  };\n\n  {}\n  {}\n\n  var addMarker = function addMarker(lat, long) {\n    webViewRef.current.injectJavaScript(\"\\n  mymap.setView([\" + lat + \", \" + long + \"], 18);\\n  L.marker([\" + lat + \", \" + long + \"]).addTo(mymap)\\n  .bindPopup(\\\"<b>HELLO</b><br />this is a test node\\\").openPopup();\");\n  };\n\n  var showSidebar = function showSidebar() {\n    setSidebar(true);\n  };\n\n  return React.createElement(View, {\n    style: styles.backgroundContainer,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 120,\n      columnNumber: 5\n    }\n  }, React.createElement(WebView, {\n    ref: webViewRef,\n    geolocationEnabled: true,\n    originWhitelist: ['*'],\n    style: {\n      flex: 1,\n      borderWidth: 1\n    },\n    source: {\n      html: html_map\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 121,\n      columnNumber: 9\n    }\n  }), React.createElement(View, {\n    style: styles.buttonContainer,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 130,\n      columnNumber: 1\n    }\n  }, React.createElement(TouchableOpacity, {\n    style: styles.button,\n    onPress: function onPress() {\n      return showSidebar();\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 131,\n      columnNumber: 11\n    }\n  }, React.createElement(MaterialCommunityIcons, {\n    name: \"map-marker-outline\",\n    color: \"#ffff\",\n    size: 20,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 13\n    }\n  }), React.createElement(Text, {\n    style: {\n      textAlign: \"center\",\n      color: \"#fff\",\n      fontWeight: \"bold\",\n      marginLeft: 4\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 142,\n      columnNumber: 13\n    }\n  }, \"Back to start point\"))), React.createElement(StepModal, {\n    modalVisible: sidebar,\n    confirmText: \"OK\",\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 151,\n      columnNumber: 3\n    }\n  }, React.createElement(View, {\n    style: {\n      flex: 1,\n      flexDirection: \"row\",\n      alignItems: \"center\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 153,\n      columnNumber: 5\n    }\n  }, React.createElement(Text, {\n    style: {\n      textAlign: \"justify\",\n      fontWeight: \"bold\",\n      right: 2\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 154,\n      columnNumber: 5\n    }\n  }, \"Submitted by: tammyc\"), React.createElement(MaterialCommunityIcons, {\n    name: \"shield\",\n    color: \"dodgerblue\",\n    size: 18,\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 155,\n      columnNumber: 7\n    }\n  })), React.createElement(Text, {\n    style: {\n      textAlign: \"justify\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 162,\n      columnNumber: 5\n    }\n  }, \"10/10/2020, 2:03 PM\"), React.createElement(TouchableOpacity, {\n    style: styles.button,\n    onPress: function onPress() {\n      return setSidebar(false);\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 163,\n      columnNumber: 5\n    }\n  }, React.createElement(Text, {\n    style: {\n      textAlign: \"center\",\n      color: \"#fff\",\n      fontWeight: \"bold\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 167,\n      columnNumber: 13\n    }\n  }, \"Close modal\")), React.createElement(View, {\n    style: {\n      borderWidth: .5,\n      width: \"100%\",\n      borderColor: \"#BCBCBC\",\n      marginHorizontal: 5,\n      marginTop: 10\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 173,\n      columnNumber: 5\n    }\n  }), React.createElement(View, {\n    style: {\n      flexDirection: \"row\",\n      marginVertical: 5\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 174,\n      columnNumber: 5\n    }\n  }, React.createElement(Text, {\n    style: {\n      textAlign: \"justify\",\n      fontWeight: \"bold\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 5\n    }\n  }, \"Latitude: \"), React.createElement(Text, {\n    style: {\n      textAlign: \"justify\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 176,\n      columnNumber: 5\n    }\n  }, \"14.476576\")), React.createElement(View, {\n    style: {\n      flexDirection: \"row\",\n      marginVertical: 5\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 5\n    }\n  }, React.createElement(Text, {\n    style: {\n      textAlign: \"justify\",\n      fontWeight: \"bold\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 5\n    }\n  }, \"Longitude: \"), React.createElement(Text, {\n    style: {\n      textAlign: \"justify\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 180,\n      columnNumber: 5\n    }\n  }, \"120.0068565\")), React.createElement(View, {\n    style: {\n      flexDirection: \"row\",\n      marginVertical: 5\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 5\n    }\n  }, React.createElement(Text, {\n    style: {\n      textAlign: \"justify\",\n      fontWeight: \"bold\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 183,\n      columnNumber: 5\n    }\n  }, \"Rain Intensity: \"), React.createElement(Text, {\n    style: {\n      textAlign: \"justify\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 184,\n      columnNumber: 5\n    }\n  }, \"Light Rain\")), React.createElement(View, {\n    style: {\n      flexDirection: \"row\",\n      marginVertical: 5\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 186,\n      columnNumber: 5\n    }\n  }, React.createElement(Text, {\n    style: {\n      textAlign: \"justify\",\n      fontWeight: \"bold\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 5\n    }\n  }, \"Flood Level: \"), React.createElement(Text, {\n    style: {\n      textAlign: \"justify\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 188,\n      columnNumber: 5\n    }\n  }, \"No flooding\")), React.createElement(View, {\n    style: {\n      marginTop: 5,\n      justifyContent: \"center\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 191,\n      columnNumber: 5\n    }\n  }, React.createElement(Text, {\n    style: {\n      textAlign: \"justify\",\n      fontWeight: \"bold\"\n    },\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 5\n    }\n  }, \"Photo: \"), React.createElement(Image, {\n    style: {\n      height: 300,\n      width: 150,\n      alignSelf: \"center\"\n    },\n    source: require(\"../../assets/sample_image.jpg\"),\n    __self: _this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 5\n    }\n  }))));\n};\n\nvar styles = StyleSheet.create({\n  backgroundContainer: {\n    flex: 1,\n    width: \"100%\",\n    backgroundColor: \"#fff\",\n    justifyContent: \"center\",\n    paddingTop: Platform.OS === \"android\" ? 25 : 0\n  },\n  contentContainer: {\n    flex: 1,\n    width: \"100%\",\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    backgroundColor: \"#434343\",\n    paddingHorizontal: 30\n  },\n  button: {\n    width: \"100%\",\n    height: 45,\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    borderRadius: 30,\n    backgroundColor: \"#1EA78C\"\n  },\n  logoContainer: {\n    flex: 1.1,\n    width: \"100%\",\n    justifyContent: \"flex-end\",\n    alignItems: \"center\",\n    backgroundColor: \"#434343\",\n    paddingBottom: 40\n  },\n  inputContainer: {\n    flex: 0.5,\n    width: \"100%\",\n    justifyContent: \"space-evenly\",\n    alignItems: \"center\",\n    backgroundColor: \"#434343\",\n    paddingTop: 40,\n    paddingHorizontal: 5\n  },\n  textInput: {\n    backgroundColor: \"#F0F3F4\",\n    marginVertical: 1.5,\n    paddingHorizontal: 10,\n    height: 40,\n    width: \"100%\",\n    borderColor: \"#dedede\",\n    borderStyle: \"solid\",\n    borderWidth: 1,\n    letterSpacing: 2,\n    alignItems: \"center\",\n    borderRadius: 30\n  },\n  button: {\n    width: \"80%\",\n    height: 45,\n    justifyContent: \"center\",\n    alignItems: \"center\",\n    alignSelf: \"center\",\n    borderRadius: 30,\n    backgroundColor: \"#27B296\",\n    flexDirection: \"row\",\n    marginVertical: 15\n  },\n  buttonContainer: {\n    flex: 1,\n    width: \"70%\",\n    position: \"absolute\",\n    alignItems: \"center\",\n    alignSelf: \"center\",\n    paddingHorizontal: 5,\n    bottom: 40\n  }\n});\nexport default HomeMap;","map":{"version":3,"sources":["D:/Github/rainflow_mobile/src/Screens/HomeMap.js"],"names":["React","Component","useState","useEffect","useRef","WebView","html_map","MaterialCommunityIcons","useFocusEffect","StepModal","HomeMap","props","markers","setMarkers","injectJS","setInjectJS","currentNodes","setCurrentNodes","sidebar","setSidebar","webViewRef","getNodes","fetch","method","headers","then","response","console","log","status","json","data","Alert","alert","addMarker","lat","long","current","injectJavaScript","showSidebar","styles","backgroundContainer","flex","borderWidth","html","buttonContainer","button","textAlign","color","fontWeight","marginLeft","flexDirection","alignItems","right","width","borderColor","marginHorizontal","marginTop","marginVertical","justifyContent","height","alignSelf","require","StyleSheet","create","backgroundColor","paddingTop","Platform","OS","contentContainer","paddingHorizontal","borderRadius","logoContainer","paddingBottom","inputContainer","textInput","borderStyle","letterSpacing","position","bottom"],"mappings":"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","sourcesContent":["import React, { Component, useState, useEffect, useRef } from \"react\";\r\nimport {\r\n  StyleSheet,\r\n  View,\r\n  Text,\r\n  TextInput,\r\n  TouchableOpacity,\r\n  Image,\r\n  Alert\r\n} from \"react-native\";\r\n\r\nimport { WebView } from \"react-native-webview\";\r\nimport { html_map } from \"./html_map\"\r\nimport { MaterialCommunityIcons } from \"react-native-vector-icons\";\r\nimport { useFocusEffect } from '@react-navigation/native';\r\nimport StepModal from \"../components/NodeModal\"\r\n\r\n\r\nconst HomeMap = (props) => {\r\nconst [markers, setMarkers] = useState()\r\nconst [injectJS, setInjectJS] = useState()\r\nconst [currentNodes, setCurrentNodes] = useState([])\r\nconst [sidebar, setSidebar] = useState(false)\r\nconst webViewRef = useRef();\r\n\r\nconst getNodes = async() => {\r\n  await fetch('https://rainflow.live/api/map/all', {\r\n    method: 'GET',\r\n    headers: {\r\n        'Content-Type': 'application/json',\r\n        'Accept' : 'application/json',\r\n    }\r\n    }).then(response => {\r\n      console.log(response.status);\r\n      if(response.status == 200)\r\n        response.json().then( data =>{setMarkers(data)});\r\n      else{\r\n        Alert.alert(\r\n          'Error retrieving reports! (Code: ' + response.status + ')');\r\n      }\r\n    })\r\n}\r\n{/*\r\n  \r\n  useEffect(()=>{\r\n    console.log(\"this has been triggered by first network request\")\r\n    const interval = setInterval(() => {\r\n      getNodes()\r\n          console.log(\"second\")\r\n            if(JSON.stringify(currentNodes) == JSON.stringify(markers)){ //\r\n              console.log(\"wala idadagdag sa map\")\r\n              currentNodes.mobile.map(data => {\r\n                console.log(\"nadagdag sa mobile\")\r\n                webViewRef.current.injectJavaScript(`L.marker([${data.latitude}, ${data.longitude}]).addTo(mymap)`)\r\n              })\r\n              currentNodes.raft.map(data => {\r\n                console.log(\"nadagdag sa RAFT\")\r\n                webViewRef.current.injectJavaScript(`L.marker([${data.latitude}, ${data.longitude}]).addTo(mymap)`)\r\n              })\r\n            }else{\r\n              console.log(\"may idadagdag sa map\")\r\n              //console.log(currentNodes)\r\n  \r\n              setCurrentNodes(markers)\r\n    \r\n             // console.log(currentNodes)\r\n            }\r\n          \r\n        \r\n    }, 10000); //every 10 seconds\r\n    return () => clearInterval(interval);\r\n  \r\n  }, [markers])\r\n  */\r\n}\r\n{/* \r\n\r\n  useEffect(()=> {\r\n    let unmounted = false;\r\n  \r\n    if(unmounted == false){\r\n  \r\n      getNodes()\r\n      setCurrentNodes(markers)\r\n      console.log(\"upon loading\")\r\n    }\r\n  \r\n    return () => {unmounted = true}\r\n  })\r\n  \r\n  useFocusEffect( // fetch again when we switch between tabs. because useeffect isnt triggered when we go from one tab to the next\r\n    React.useCallback(() => {\r\n      let isActive = true;\r\n      getNodes()\r\n      setCurrentNodes(markers)\r\n  \r\n      return () => {\r\n        isActive = false;\r\n      };\r\n    })\r\n  );\r\n*/}\r\n\r\n\r\n\r\nconst addMarker = (lat, long) => {\r\n  webViewRef.current.injectJavaScript(`\r\n  mymap.setView([${lat}, ${long}], 18);\r\n  L.marker([${lat}, ${long}]).addTo(mymap)\r\n  .bindPopup(\"<b>HELLO</b><br />this is a test node\").openPopup();`\r\n  )\r\n} \r\n\r\nconst showSidebar = () => {\r\n\r\nsetSidebar(true)\r\n  \r\n}\r\n  return (\r\n    <View style = {styles.backgroundContainer}>\r\n        <WebView\r\n          ref = {webViewRef}\r\n          geolocationEnabled = {true}\r\n          originWhitelist={['*']}\r\n          style={{flex: 1, borderWidth: 1}}\r\n       //   injectedJavaScript = {marker}\r\n            source={{ html: html_map}} \r\n          />\r\n\r\n<View style={styles.buttonContainer}>\r\n          <TouchableOpacity\r\n            style={styles.button}\r\n            onPress={() =>\r\n              showSidebar()\r\n            }\r\n          >\r\n            <MaterialCommunityIcons\r\n                name=\"map-marker-outline\"\r\n                color=\"#ffff\"\r\n                size={20}\r\n              />\r\n            <Text\r\n              style={{ textAlign: \"center\", color: \"#fff\", fontWeight: \"bold\", marginLeft: 4}}\r\n            >\r\n              Back to start point \r\n            </Text>\r\n          </TouchableOpacity>\r\n  \r\n        </View>\r\n\r\n  <StepModal  modalVisible={sidebar}  confirmText={\"OK\"}>\r\n\r\n    <View style = {{flex:1, flexDirection: \"row\", alignItems: \"center\"}}>\r\n    <Text style = {{textAlign: \"justify\", fontWeight: \"bold\", right: 2}}>Submitted by: tammyc</Text>\r\n      <MaterialCommunityIcons\r\n                    name=\"shield\"\r\n                    color=\"dodgerblue\"\r\n                    size={18}\r\n                  />\r\n        </View>\r\n \r\n    <Text style = {{textAlign: \"justify\"}}>10/10/2020, 2:03 PM</Text>\r\n    <TouchableOpacity\r\n            style={styles.button}\r\n            onPress={() => setSidebar(false)}\r\n          >\r\n            <Text\r\n              style={{ textAlign: \"center\", color: \"#fff\", fontWeight: \"bold\" }}\r\n            >\r\n              Close modal\r\n            </Text>\r\n          </TouchableOpacity>\r\n    <View style = {{borderWidth: .5, width: \"100%\", borderColor: \"#BCBCBC\", marginHorizontal: 5, marginTop: 10}} />\r\n    <View style = {{flexDirection: \"row\", marginVertical: 5}}>\r\n    <Text style = {{textAlign: \"justify\", fontWeight: \"bold\"}}>Latitude: </Text>\r\n    <Text style = {{textAlign: \"justify\"}}>14.476576</Text>\r\n    </View>\r\n    <View style = {{flexDirection: \"row\", marginVertical: 5}}>\r\n    <Text style = {{textAlign: \"justify\", fontWeight: \"bold\"}}>Longitude: </Text>\r\n    <Text style = {{textAlign: \"justify\"}}>120.0068565</Text>\r\n    </View>\r\n    <View style = {{flexDirection: \"row\", marginVertical: 5}}>\r\n    <Text style = {{textAlign: \"justify\", fontWeight: \"bold\"}}>Rain Intensity: </Text>\r\n    <Text style = {{textAlign: \"justify\"}}>Light Rain</Text>\r\n    </View>\r\n    <View style = {{flexDirection: \"row\", marginVertical: 5}}>\r\n    <Text style = {{textAlign: \"justify\", fontWeight: \"bold\"}}>Flood Level: </Text>\r\n    <Text style = {{textAlign: \"justify\"}}>No flooding</Text>\r\n    </View>\r\n\r\n    <View style={{marginTop: 5, justifyContent: \"center\"}}>\r\n\r\n    <Text style = {{textAlign: \"justify\", fontWeight: \"bold\"}}>Photo: </Text>\r\n    <Image style={{height: 300, width: 150, alignSelf: \"center\"}}\r\n            source={require('../../assets/sample_image.jpg')  }/>\r\n    </View>\r\n\r\n</StepModal>\r\n</View>\r\n\r\n    \r\n  );\r\n};\r\n\r\nconst styles = StyleSheet.create({\r\n  backgroundContainer: {\r\n    flex: 1,\r\n    width: \"100%\",\r\n    backgroundColor: \"#fff\",\r\n    justifyContent: \"center\",\r\n    paddingTop: Platform.OS === \"android\" ? 25 : 0,\r\n  },\r\n\r\n  contentContainer: {\r\n    flex: 1,\r\n    width: \"100%\",\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n    backgroundColor: \"#434343\",\r\n    paddingHorizontal: 30,\r\n  },\r\n\r\n  button: {\r\n    width: \"100%\",\r\n    height: 45,\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n    borderRadius: 30,\r\n    backgroundColor: \"#1EA78C\",\r\n  },\r\n\r\n  logoContainer: {\r\n    flex: 1.1,\r\n    width: \"100%\",\r\n    justifyContent: \"flex-end\",\r\n    alignItems: \"center\",\r\n    backgroundColor: \"#434343\",\r\n    paddingBottom: 40,\r\n  },\r\n\r\n  inputContainer: {\r\n    flex: 0.5,\r\n    width: \"100%\",\r\n    justifyContent: \"space-evenly\",\r\n    alignItems: \"center\",\r\n    backgroundColor: \"#434343\",\r\n    paddingTop: 40,\r\n    paddingHorizontal: 5,\r\n  },\r\n\r\n  textInput: {\r\n    backgroundColor: \"#F0F3F4\",\r\n    marginVertical: 1.5,\r\n    paddingHorizontal: 10,\r\n    height: 40,\r\n    width: \"100%\",\r\n    borderColor: \"#dedede\",\r\n    borderStyle: \"solid\",\r\n    borderWidth: 1,\r\n    letterSpacing: 2,\r\n    alignItems: \"center\",\r\n    borderRadius: 30,\r\n  },\r\n\r\n  button: {\r\n    width: \"80%\",\r\n    height: 45,\r\n    justifyContent: \"center\",\r\n    alignItems: \"center\",\r\n    alignSelf: \"center\",\r\n    borderRadius: 30,\r\n    backgroundColor: \"#27B296\",\r\n    flexDirection: \"row\",\r\n    marginVertical: 15\r\n  \r\n  },\r\n\r\n  buttonContainer: {\r\n    flex: 1,\r\n    width: \"70%\",\r\n   position: \"absolute\",\r\n    alignItems: \"center\",\r\n    alignSelf: \"center\",\r\n    paddingHorizontal: 5,\r\n    bottom:40,\r\n  },\r\n});\r\n\r\nexport default HomeMap;\r\n"]},"metadata":{},"sourceType":"module"}